/* ==========================================================================
   Lazyload
   ========================================================================== */

/**
 * Lazyload figureimage
 */

.FigureImage-lazy {
	position: relative;
	display: block;
	background-color: $color-gray-quiet;

	.ctm & {
		overflow: hidden;
		// height: 0; // Height is set by inline percentage-padding in figure plugin/tag to prevent reflow on image load

		&.lazyload:after {
			position: absolute;
			right: rhythm(.5);
			bottom: rhythm(.5);
			width: rhythm(.24);
			height: rhythm(.24);
			margin: rhythm(-.12) 0 0 rhythm(-.12);
			content: "";
			animation: Flash 1.76s cubic-bezier(.6,1,1,1) infinite; // Loading animation
			border-radius: 100%;
			background: rgba($color-base-black,.24);
		}
		.FigureImage-item {
			position: absolute; // Aboslute positioned within percentage-padding set height element
			top: 0;
			left: 0;

			// To discuss: hide image while lazysizes is not finished. To prevent image flashing after lazysizes has loaded.
			&.lazyload {
				opacity: 0;
			}
			&.lazyloading {
				opacity: 0; // Hide lazyloaded image (with lazysizes) as soon as possibe. Fixes flicker of cached images on iOS!
			}
			&.lazyloaded {
				animation: FadeIn .56s ease-in both; // Fade-in animation of (lazy)loaded images
			}
		}
	}
}

/**
 * Lazyload bgimage
 */

.BgImage {

	&.lazyloaded {
		animation: FadeIn .56s ease-in both; // Fade-in animation
	}
}
